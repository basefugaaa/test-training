<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Тренировка по тестам</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 900px; margin: auto; }
    .question { margin-bottom: 20px; font-weight: bold; }
    .options button { display: block; margin: 5px 0; width: 100%; padding: 10px; font-size: 16px; }
    .result { margin-top: 10px; font-weight: bold; }
    .correct { color: green; }
    .incorrect { color: red; }

    #question-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 20px;
    }
    .question-tile {
      width: 32px;
      height: 32px;
      border: 1px solid #ccc;
      text-align: center;
      line-height: 32px;
      font-size: 14px;
      cursor: pointer;
      background-color: white;
      transition: background-color 0.2s, color 0.2s;
    }
    .question-tile.current {
      border: 2px solid #007bff;
      font-weight: bold;
    }
    .question-tile.correct {
      background-color: #c8f7c5;
    }
    .question-tile.incorrect {
      background-color: #f7c5c5;
    }

    #summary {
      margin-top: 20px;
      font-weight: bold;
    }
  </style>
  <script src="questions.js"></script>
</head>
<body>

<h1>Режим тренировки</h1>

<div id="question-grid"></div>

<div id="quiz">
  <div class="question" id="question-text">Загрузка...</div>
  <div class="options" id="options"></div>
  <div class="result" id="result"></div>
  <button onclick="nextQuestion()">Следующий вопрос</button>
</div>

<div id="summary"></div>

<script>
questions = questions.sort(() => Math.random() - 0.5);

let current = 0;
let answers = Array(questions.length).fill(null); // null | true | false

function updateGrid() {
  const grid = document.getElementById('question-grid');
  grid.innerHTML = '';
  answers.forEach((ans, index) => {
    const tile = document.createElement('div');
    tile.textContent = index + 1;
    tile.className = 'question-tile';
    if (index === current) tile.classList.add('current');
    if (ans === true) tile.classList.add('correct');
    if (ans === false) tile.classList.add('incorrect');
    tile.onclick = () => {
      current = index;
      showQuestion();
    };
    grid.appendChild(tile);
  });
}

function updateSummary() {
  const correct = answers.filter(a => a === true).length;
  const incorrect = answers.filter(a => a === false).length;
  const unanswered = answers.filter(a => a === null).length;
  document.getElementById('summary').textContent =
    `✅ Верно: ${correct} | ❌ Неверно: ${incorrect} | ⏳ Осталось: ${unanswered}`;
}

function showQuestion() {
  const q = questions[current];
  document.getElementById('question-text').textContent = q.question;
  const options = document.getElementById('options');
  options.innerHTML = '';
  const result = document.getElementById('result');
  result.textContent = '';

  q.options.forEach((opt, idx) => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.onclick = () => {
      const isCorrect = idx === q.correct;
      answers[current] = isCorrect;
      result.textContent = isCorrect ? "✅ Правильно!" : "❌ Неправильно!";
      result.className = "result " + (isCorrect ? "correct" : "incorrect");
      updateGrid();
      updateSummary();
    };
    options.appendChild(btn);
  });

  updateGrid();
  updateSummary();
}

function nextQuestion() {
  current = (current + 1) % questions.length;
  showQuestion();
}

showQuestion();
</script>

</body>
</html>
